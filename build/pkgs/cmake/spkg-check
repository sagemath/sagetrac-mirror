#!/usr/bin/env bash

cd src
unset MACOSX_DEPLOYMENT_TARGET
# Supress tests failing for reason out of our controls
FAILING_TESTS="CTestTestStopTime|TestUpload|ctest_submit"
# gui interface may pull dependency conflicting with
# sage libraries
# (1) QT libraries
FAILING_TESTS="${FAILING_TESTS}|Qt5Autogen|Qt4Autogen|Qt4Targets|Qt4And5AutomocReverse"
# (2) GTK2
FAILING_TESTS="${FAILING_TESTS}|GTK2Components|GTK2Targets"
ctest --extra-verbose --output-on-failure -E "(${FAILING_TESTS})"

