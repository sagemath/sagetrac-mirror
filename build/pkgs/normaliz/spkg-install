#!/usr/bin/env sh

die () {
    echo "$@" 1>&2
    exit 1
}

[ -n "$SAGE_LOCAL" ] || die 'Error: $SAGE_LOCAL not set. Source sage-env or run this script from `sage -sh`.'

cd src

export CXXFLAGS="-I$SAGE_LOCAL/include $CXXFLAGS $LDFLAGS"
cd source
$MAKE || die "Error building Normaliz."

cp -pf normaliz "$SAGE_LOCAL/bin/" || die "Error installing Normaliz."

cd ../Singular
cp -pf normaliz.lib "$SAGE_LOCAL/share/singular/" || die "Error installing normaliz.lib for Singular."

