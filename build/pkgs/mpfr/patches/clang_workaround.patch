diff --git a/src/set_d.c b/src/set_d.c
index c076ccf..0b71cff 100644
--- a/src/set_d.c
+++ b/src/set_d.c
@@ -118,7 +118,7 @@ __gmpfr_extract_double (mpfr_limb_ptr rp, double d)
 
     d *= MP_BASE_AS_DOUBLE;
 #if GMP_NUMB_BITS >= 64
-    manl = d;
+    manl = 0x8000000000000000 + (mp_limb_t) (d - 9223372036854775808.0);
 #else
     manh = (mp_limb_t) d;
     manl = (mp_limb_t) ((d - manh) * MP_BASE_AS_DOUBLE);
