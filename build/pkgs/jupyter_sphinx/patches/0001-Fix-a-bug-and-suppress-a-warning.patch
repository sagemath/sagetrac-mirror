From f93e4ea3eaedd549b56bc86f27225aee2f4c847d Mon Sep 17 00:00:00 2001
From: Kwankyu Lee <ekwankyu@gmail.com>
Date: Sun, 27 Mar 2022 13:33:56 -0700
Subject: [PATCH 1/4] Fix a bug and suppress a warning

---
 jupyter_sphinx/execute.py | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

diff --git a/jupyter_sphinx/execute.py b/jupyter_sphinx/execute.py
index e6cc5db..ef41337 100644
--- a/jupyter_sphinx/execute.py
+++ b/jupyter_sphinx/execute.py
@@ -147,11 +147,14 @@ class ExecuteJupyterCells(SphinxTransform):
                 kernel_name = default_kernel
                 file_name = next(default_names)
 
-            notebook = execute_cells(
-                kernel_name,
-                [nbformat.v4.new_code_cell(node.astext()) for node in nodes],
-                self.config.jupyter_execute_kwargs,
-            )
+            import warnings
+            with warnings.catch_warnings():
+                warnings.simplefilter("ignore")
+                notebook = execute_cells(
+                    kernel_name,
+                    [nbformat.v4.new_code_cell(node.astext() if not "execute" in node or node["execute"] else "") for node in nodes],
+                    self.config.jupyter_execute_kwargs,
+                )
 
             # Raise error if cells raised exceptions and were not marked as doing so
             for node, cell in zip(nodes, notebook.cells):
-- 
2.35.1

