if [ "$SAGE64" = yes ]; then
    echo "Building a 64-bit version of eclib."
    if [ -z "$CFLAG64" ]; then
        CFLAG64=-m64
    fi
    if [ -z "$CXXFLAG64" ]; then
        CXXFLAG64=$CFLAG64
    fi
    CFLAGS="$CFLAGS $CFLAG64"
    CXXFLAGS="$CXXFLAGS $CXXFLAG64"
    CPPFLAGS="$CPPFLAGS $CFLAG64"
    LDFLAGS="$LDFLAGS $CFLAG64" # or $CXXFLAG64
fi

if [ "$SAGE_DEBUG" = yes ]; then
    echo >&2 "Warning: Setting SAGE_DEBUG=yes completely disables optimization."
    CFLAGS="$CFLAGS -g -O0"
    CXXFLAGS="$CXXFLAGS -g -O0"
else
    # Add debug symbols by default, enable optimization, but let the user
    # still override these settings:
    CFLAGS="-g -O3 $CFLAGS"
    CXXFLAGS="-g -O3 $CXXFLAGS"
fi

export CFLAGS CPPFLAGS CXXFLAGS LDFLAGS


cd src/


sdh_configure --with-ntl="$SAGE_LOCAL" \
              --with-pari="$SAGE_LOCAL" \
              --with-flint="$SAGE_LOCAL" \
              --with-boost="no" \
              --disable-allprogs
sdh_make
sdh_make_install
