# -*- shell-script -*-
cd src

# This is the minimum list of subpackages needed for cvxopt
# The order is important since there are dependencies.
pkg_list="SuiteSparse_config AMD CAMD COLAMD CCOLAMD CHOLMOD UMFPACK"

for pkg in ${pkg_list}; do
	pushd "${pkg}/build"
	# configuring with cmake to:
	# Enforce usage of OpenBlas
	# No static libraries
	# Verbose builds
	sdh_cmake \
		-DBLA_VENDOR=OpenBLAS \
		-DBLAS_LIBRARIES="$(pkg-config --libs blas)" \
		-DLAPACK_LIBRARIES="$(pkg-config --libs lapack)" \
		-DNSUPERNODAL=ON \
		-DNSTATIC=ON -DCMAKE_VERBOSE_MAKEFILE=1 ..
	# Build
	sdh_make
	popd
done
